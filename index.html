<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>3D 流光爱心</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }

        canvas {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        /* 文字容器 */
        .text-container {
            position: absolute;
            z-index: 10;
            text-align: center;
            width: 100%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none; /* 让点击穿透 */
            mix-blend-mode: screen; /* 混合模式，让文字融入光效 */
        }

        /* 主标题 */
        .main-title {
            font-size: 2.5rem;
            font-weight: 800;
            letter-spacing: 2px;
            /* 动态渐变字色 */
            background: linear-gradient(to right, #ff00cc, #3333ff, #ff00cc);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: textFlow 3s linear infinite, float 3s ease-in-out infinite;
        }

        /* 副标题 */
        .sub-title {
            font-size: 1rem;
            margin-top: 10px;
            font-weight: 300;
            color: #fff;
            opacity: 0.8;
            letter-spacing: 1px;
            animation: colorPulse 4s infinite alternate;
        }

        /* 简单的文字浮动动画 */
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* 文字流光动画 */
        @keyframes textFlow {
            to { background-position: 200% center; }
        }
        
        /* 副标题颜色脉冲 */
        @keyframes colorPulse {
            0% { color: #ff9a9e; text-shadow: 0 0 10px #ff9a9e; }
            100% { color: #a18cd1; text-shadow: 0 0 10px #a18cd1; }
        }

    </style>
</head>
<body>

    <canvas id="canvas"></canvas>

    <!-- 在此处修改文字 -->
    <div class="text-container">
        <div class="main-title">Happy New Year's Day</div>
        <div class="sub-title">May the coming year bring you as much joy and happiness as you've brought into my life.</div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        let width, height;
        let particles = [];
        
        // 核心配置
        const AMOUNT = 600; // 粒子数量，手机端建议 500-800，电脑端可 1000+
        const SCALE = 15;   // 爱心基础大小
        const SPEED = 0.002; // 旋转速度

        // 3D 投影参数
        const PROJECTION_CENTER_X = width / 2;
        const PROJECTION_CENTER_Y = height / 2;
        const FIELD_OF_VIEW = 600; // 视距，越小透视越强

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            // 重新初始化中心点
            particles.forEach(p => {
                p.cx = width / 2;
                p.cy = height / 2;
            });
        }
        window.addEventListener('resize', resize);

        // 3D 粒子类
        class Particle {
            constructor(index) {
                this.init(index);
            }

            init(index) {
                // 利用数学公式在 3D 空间生成爱心形状
                // 我们可以使用 2D 爱心公式，赋予它随机的 Z 轴厚度，或者使用球体映射
                
                // 这里使用经典的参数方程生成分布
                // $$ x = 16\sin^3(t) $$
                // $$ y = -(13\cos(t) - 5\cos(2t) - 2\cos(3t) - \cos(4t)) $$
                
                let t = Math.random() * Math.PI * 2;
                
                // 随机化半径，填充爱心内部，而不仅仅是边缘
                // 使用 sqrt(random) 保证分布均匀
                let r = Math.sqrt(Math.random()); 
                
                // 基础 2D 坐标
                let x = 16 * Math.pow(Math.sin(t), 3);
                let y = -(13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t));
                
                // 增加 3D 维度 (Z轴)
                // 让粒子在 Z 轴上有厚度，形成一个立体的爱心
                // 靠近边缘的粒子 Z 轴范围小，靠近中心的 Z 轴范围大，形成圆润感
                let depth = (2 - Math.abs(x)/10) * 4; 
                let z = (Math.random() - 0.5) * depth * 5; 

                // 缩放
                this.x = x * SCALE * r;
                this.y = y * SCALE * r;
                this.z = z * SCALE; // Z 轴也缩放

                // 原始坐标备份（用于旋转计算）
                this.ox = this.x;
                this.oy = this.y;
                this.oz = this.z;

                this.cx = width / 2;
                this.cy = height / 2;
                
                // 粒子自身的大小
                this.size = Math.random() * 2 + 1;
            }

            draw(angle, tick) {
                // 1. 3D 旋转计算 (绕 Y 轴旋转)
                // 旋转公式：
                // $$ x' = x\cos\theta - z\sin\theta $$
                // $$ z' = x\sin\theta + z\cos\theta $$
                
                let rx = this.ox * Math.cos(angle) - this.oz * Math.sin(angle);
                let rz = this.ox * Math.sin(angle) + this.oz * Math.cos(angle);
                // 加上一点点 X 轴旋转，让它看起来稍微仰视一点
                let ry = this.oy; 

                // 2. 投影到 2D 屏幕 (Perspective Projection)
                // $$ scale = \frac{f}{f + z} $$
                let scale = FIELD_OF_VIEW / (FIELD_OF_VIEW + rz);
                
                let x2d = rx * scale + width / 2;
                let y2d = ry * scale + height / 2;

                // 3. 计算颜色 (动态流光)
                // HSL 色相随时间 (tick) 和位置 (rx) 变化
                // 使得左边和右边的颜色不一样，产生渐变感
                let hue = (tick + rx * 2) % 360; 
                let alpha = scale; // 离得越远越透明

                // 4. 绘制
                ctx.fillStyle = `hsla(${hue}, 80%, 60%, ${alpha})`;
                ctx.beginPath();
                // 离得近的粒子画大一点
                ctx.arc(x2d, y2d, this.size * scale, 0, Math.PI * 2); 
                ctx.fill();
            }
        }

        function initParticles() {
            resize();
            particles = [];
            for (let i = 0; i < AMOUNT; i++) {
                particles.push(new Particle(i));
            }
        }

        let angle = 0;
        let tick = 0; // 时间戳，用于控制颜色

        function animate() {
            // 清除画布，使用带透明度的黑色，形成轻微拖尾
            ctx.fillStyle = "rgba(0, 0, 0, 0.15)";
            ctx.fillRect(0, 0, width, height);

            angle += SPEED; // 增加旋转角度
            tick += 1;      // 增加颜色流转速度

            particles.forEach(p => p.draw(angle, tick));

            requestAnimationFrame(animate);
        }

        initParticles();
        animate();

    </script>
</body>
</html>
